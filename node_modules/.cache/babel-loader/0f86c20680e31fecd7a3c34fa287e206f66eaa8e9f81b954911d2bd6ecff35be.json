{"ast":null,"code":"import { osName, browserName } from 'react-device-detect';\nimport { delegate, emitUIInteraction, config } from '../DOMDelegate';\nimport React, { useState, useEffect, useRef } from 'react';\nconst handleSubmit = (userName, password, firstTimeUser, consentAccepted, device, setFormStep) => {\n  if (userName && password && firstTimeUser !== null && consentAccepted) {\n    const port = {\n      tankhouse: 1111,\n      dev: 2222,\n      officedemo: 3333,\n      epic: 4444,\n      demo: 5555,\n      prophet: 7777\n    };\n    const data = {\n      deviceType: device,\n      osName: osName,\n      browserName: browserName,\n      mobileUser: config.isMobile,\n      userName: userName,\n      consentAccepted: consentAccepted,\n      firstTimeUser: firstTimeUser ? \"Yes\" : \"No\",\n      password: password,\n      timestamp: new Date().getTime(),\n      // current time in Epoch time\n      join: 'palatial.tenant-palatial-platform.coreweave.cloud:' + port[delegate.appName]\n    };\n    const waitForLevelReady = () => {\n      return new Promise((resolve, reject) => {\n        const checkReady = () => {\n          if (delegate.levelReady) {\n            resolve(true);\n          } else {\n            setTimeout(checkReady, 100);\n          }\n        };\n        checkReady();\n      });\n    };\n    const videoElement = document.getElementById(\"myVideo\");\n    videoElement.play();\n    delegate.checkStreamReady(async () => {\n      emitUIInteraction(data);\n      const loadingStep = document.querySelector(\".loadingStep\");\n      setTimeout(() => {\n        loadingStep.textContent = \"Starting\";\n      }, 480);\n      waitForLevelReady().then(() => {\n        const root = document.getElementById(\"root\");\n        delegate.loadingProgress = 100;\n        root.classList.add(\"fade-out\");\n        setTimeout(() => {\n          setFormStep(1);\n          loadingStep.textContent = \"Ready\";\n          delegate.levelReady = false;\n        }, 1000);\n      }).catch(e => {\n        console.log(e);\n      });\n    });\n  } else {\n    // handle incomplete form\n  }\n};\nexport default handleSubmit;","map":{"version":3,"names":["osName","browserName","delegate","emitUIInteraction","config","React","useState","useEffect","useRef","handleSubmit","userName","password","firstTimeUser","consentAccepted","device","setFormStep","port","tankhouse","dev","officedemo","epic","demo","prophet","data","deviceType","mobileUser","isMobile","timestamp","Date","getTime","join","appName","waitForLevelReady","Promise","resolve","reject","checkReady","levelReady","setTimeout","videoElement","document","getElementById","play","checkStreamReady","loadingStep","querySelector","textContent","then","root","loadingProgress","classList","add","catch","e","console","log"],"sources":["C:/Users/employee/Palatial-Web-Loading/src/utils/handleSubmit.js"],"sourcesContent":["import { osName, browserName } from 'react-device-detect';\nimport { delegate, emitUIInteraction, config } from '../DOMDelegate';\nimport React, { useState, useEffect, useRef } from 'react';\n\nconst handleSubmit = (userName, password, firstTimeUser, consentAccepted, device, setFormStep) => {\n  if (userName && password && firstTimeUser !== null && consentAccepted) {\n    const port = {\n      tankhouse:  1111,\n      dev:        2222,\n      officedemo: 3333,\n      epic:       4444,\n      demo:       5555,\n      prophet:    7777,\n    };\n\n    const data = {\n      deviceType: device,\n      osName: osName,\n      browserName: browserName,\n      mobileUser: config.isMobile,\n      userName: userName,\n      consentAccepted: consentAccepted,\n      firstTimeUser: firstTimeUser ? \"Yes\" : \"No\",\n      password: password,\n      timestamp: new Date().getTime(), // current time in Epoch time\n      join: 'palatial.tenant-palatial-platform.coreweave.cloud:' + port[delegate.appName]\n    };\n\n    const waitForLevelReady = () => {\n      return new Promise((resolve, reject) => {\n        const checkReady = () => {\n          if (delegate.levelReady) {\n            resolve(true);\n          } else {\n            setTimeout(checkReady, 100);\n          }\n        };\n        checkReady();\n      });\n    };\n\n    const videoElement = document.getElementById(\"myVideo\");\n    videoElement.play();\n\n    delegate.checkStreamReady(async () => {\n      emitUIInteraction(data);\n\n      const loadingStep = document.querySelector(\".loadingStep\");\n\n      setTimeout(() => { loadingStep.textContent = \"Starting\"; }, 480);\n\n      waitForLevelReady().then(() => {\n        const root = document.getElementById(\"root\");\n        delegate.loadingProgress = 100;\n        root.classList.add(\"fade-out\");\n        setTimeout(() => {\n\t  setFormStep(1);\n\t  loadingStep.textContent = \"Ready\";\n\t  delegate.levelReady = false;\n        }, 1000);\n      }).catch(e => {\n\tconsole.log(e);\n      });\n    });\n  } else {\n    // handle incomplete form\n  }\n};\n\nexport default handleSubmit;\n"],"mappings":"AAAA,SAASA,MAAM,EAAEC,WAAW,QAAQ,qBAAqB;AACzD,SAASC,QAAQ,EAAEC,iBAAiB,EAAEC,MAAM,QAAQ,gBAAgB;AACpE,OAAOC,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAE1D,MAAMC,YAAY,GAAGA,CAACC,QAAQ,EAAEC,QAAQ,EAAEC,aAAa,EAAEC,eAAe,EAAEC,MAAM,EAAEC,WAAW,KAAK;EAChG,IAAIL,QAAQ,IAAIC,QAAQ,IAAIC,aAAa,KAAK,IAAI,IAAIC,eAAe,EAAE;IACrE,MAAMG,IAAI,GAAG;MACXC,SAAS,EAAG,IAAI;MAChBC,GAAG,EAAS,IAAI;MAChBC,UAAU,EAAE,IAAI;MAChBC,IAAI,EAAQ,IAAI;MAChBC,IAAI,EAAQ,IAAI;MAChBC,OAAO,EAAK;IACd,CAAC;IAED,MAAMC,IAAI,GAAG;MACXC,UAAU,EAAEV,MAAM;MAClBd,MAAM,EAAEA,MAAM;MACdC,WAAW,EAAEA,WAAW;MACxBwB,UAAU,EAAErB,MAAM,CAACsB,QAAQ;MAC3BhB,QAAQ,EAAEA,QAAQ;MAClBG,eAAe,EAAEA,eAAe;MAChCD,aAAa,EAAEA,aAAa,GAAG,KAAK,GAAG,IAAI;MAC3CD,QAAQ,EAAEA,QAAQ;MAClBgB,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;MAAE;MACjCC,IAAI,EAAE,oDAAoD,GAAGd,IAAI,CAACd,QAAQ,CAAC6B,OAAO;IACpF,CAAC;IAED,MAAMC,iBAAiB,GAAGA,CAAA,KAAM;MAC9B,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;QACtC,MAAMC,UAAU,GAAGA,CAAA,KAAM;UACvB,IAAIlC,QAAQ,CAACmC,UAAU,EAAE;YACvBH,OAAO,CAAC,IAAI,CAAC;UACf,CAAC,MAAM;YACLI,UAAU,CAACF,UAAU,EAAE,GAAG,CAAC;UAC7B;QACF,CAAC;QACDA,UAAU,CAAC,CAAC;MACd,CAAC,CAAC;IACJ,CAAC;IAED,MAAMG,YAAY,GAAGC,QAAQ,CAACC,cAAc,CAAC,SAAS,CAAC;IACvDF,YAAY,CAACG,IAAI,CAAC,CAAC;IAEnBxC,QAAQ,CAACyC,gBAAgB,CAAC,YAAY;MACpCxC,iBAAiB,CAACoB,IAAI,CAAC;MAEvB,MAAMqB,WAAW,GAAGJ,QAAQ,CAACK,aAAa,CAAC,cAAc,CAAC;MAE1DP,UAAU,CAAC,MAAM;QAAEM,WAAW,CAACE,WAAW,GAAG,UAAU;MAAE,CAAC,EAAE,GAAG,CAAC;MAEhEd,iBAAiB,CAAC,CAAC,CAACe,IAAI,CAAC,MAAM;QAC7B,MAAMC,IAAI,GAAGR,QAAQ,CAACC,cAAc,CAAC,MAAM,CAAC;QAC5CvC,QAAQ,CAAC+C,eAAe,GAAG,GAAG;QAC9BD,IAAI,CAACE,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;QAC9Bb,UAAU,CAAC,MAAM;UACtBvB,WAAW,CAAC,CAAC,CAAC;UACd6B,WAAW,CAACE,WAAW,GAAG,OAAO;UACjC5C,QAAQ,CAACmC,UAAU,GAAG,KAAK;QACtB,CAAC,EAAE,IAAI,CAAC;MACV,CAAC,CAAC,CAACe,KAAK,CAACC,CAAC,IAAI;QACnBC,OAAO,CAACC,GAAG,CAACF,CAAC,CAAC;MACT,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,MAAM;IACL;EAAA;AAEJ,CAAC;AAED,eAAe5C,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}